{% extends "base.html" %}

{% block title %}Top Domains & Age Gate{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 py-6 space-y-6">
  {% include "header.html" %}
  {% include "navigation.html" %}
  
  <!-- Domains Age Gate Section -->
  {% include "domains_age_gate.html" %}
  
  <!-- Back to Dashboard -->
  <div class="text-center">
    <a href="/" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
      ‚Üê Back to Dashboard
    </a>
  </div>
</div>
{% endblock %}

{% block scripts %}
{% include "scripts.html" %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Load only domains-related data
  loadEvents().then(events => {
    if (events.length > 0) {
      const currentEvent = events[0];
      loadTopDomains(currentEvent);
      loadAgeGateStatus(currentEvent);
      loadAgeGatePct(currentEvent);
    }
  });
});

async function loadEvents() {
  try {
    const data = await fetch('/api/events').then(r => r.json());
    return data.events || data || [];
  } catch (e) {
    console.error('Error loading events:', e);
    return [];
  }
}
</script>
{% endblock %}
